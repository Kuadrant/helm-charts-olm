{{ if .Values.tools.coredns.enable }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: coredns
  namespace: {{ .Values.tools.namespace }}
  labels:
    app: coredns
data:
  Corefile: |-
    kdrnt {
      debug
      errors
      health {
        lameduck 5s
      }
      ready
      log
      transfer {
        to *
      }
      kuadrant
      prometheus 0.0.0.0:9153
    }
    {{ .Values.tools.coredns.zone }} {
      debug
      errors
      log
      geoip GeoLite2-City-demo.mmdb {
        edns-subnet
      }
      metadata
      transfer {
        to *
      }
      kuadrant
      prometheus 0.0.0.0:9153
    }
{{ end }}
